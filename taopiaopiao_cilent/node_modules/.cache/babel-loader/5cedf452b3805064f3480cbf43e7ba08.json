{"ast":null,"code":"import _defineProperty from \"E:\\\\H5\\\\react\\\\taopiaopiao\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"E:\\\\H5\\\\react\\\\taopiaopiao\\\\src\\\\components\\\\List.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React from 'react';\nimport './List.css';\nimport { ListView } from 'antd-mobile';\nimport $ from 'jquery';\nimport IsPurser from './IsPurser';\nconst dataSource = new ListView.DataSource({\n  rowHasChanged: (row1, row2) => row1 !== row2\n});\nconst NUM_ROWS = 100;\n\nfunction genData(pIndex = 0) {\n  const dataBlob = {};\n\n  for (let i = 0; i < NUM_ROWS; i++) {\n    const ii = pIndex * NUM_ROWS + i;\n    dataBlob[\"\".concat(ii)] = \"row - \".concat(ii);\n  }\n\n  return dataBlob;\n}\n\nexport default class List extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.onEndReached = event => {\n      // load new data\n      // hasMore: from backend data, indicates whether it is the last page, here is false\n      if (this.state.isLoading && !this.state.hasMore) {\n        return;\n      }\n\n      console.log('reach end', event);\n      this.setState({\n        isLoading: true\n      });\n      setTimeout(() => {\n        this.rData = _objectSpread({}, this.rData, {}, this.genData(++this.pageIndex));\n        this.setState({\n          dataSource: this.state.dataSource.cloneWithRows(this.rData),\n          isLoading: false\n        });\n      }, 1000);\n    };\n\n    this.state = {\n      dataSource,\n      isLoading: true,\n      isShow: props.isShow,\n      NUM_ROWS: 40,\n      pageIndex: 0,\n      data1: []\n    };\n  }\n\n  componentDidMount() {\n    console.log(this.state.isShow);\n    let data1 = null;\n    $.ajax({\n      url: \"http://localhost:9000/getindex\",\n      type: \"GET\",\n      dataType: \"text\",\n\n      success(data) {\n        if (data) {\n          data = JSON.parse(data);\n          data1 = data;\n        }\n      },\n\n      error() {}\n\n    });\n    setTimeout(() => {\n      this.rData = genData();\n      this.setState({\n        dataSource: this.state.dataSource.cloneWithRows(this.rData),\n        isLoading: false,\n        data1: data1\n      });\n    }, 600);\n  }\n\n  render() {\n    if (this.state.data1 != null) {\n      //所有的电影列表\n      let movielist = this.state.data1; //已经上映的电影\n\n      let list1 = []; //未上映的电影\n\n      let list2 = [];\n      let year = new Date().getFullYear();\n      let month = new Date().getMonth() + 1;\n      let date = new Date().getDate();\n\n      if (movielist != null) {\n        for (let i = 0; i < movielist.length; i++) {\n          let movieYear = Number(movielist[i].moviedate.substring(0, 4));\n          let movieMonth = Number(movielist[i].moviedate.substring(5, 7));\n          let moviedate = Number(movielist[i].moviedate.substring(8, 10)) + 1;\n\n          if (movieYear > year) {\n            list2.push(movielist[i]);\n          } else if (movieYear < year) {\n            list1.push(movielist[i]);\n          } else {\n            if (movieMonth > month) {\n              list2.push(movielist[i]);\n            } else if (movieMonth < month) {\n              list1.push(movielist[i]);\n            } else {\n              if (moviedate > date) {\n                list2.push(movielist[i]);\n              } else {\n                list1.push(movielist[i]);\n              }\n            }\n          }\n        }\n      }\n\n      var data = [];\n\n      if (this.state.isShow == true) {\n        data = list1;\n        console.log(data);\n      } else {\n        data = list2;\n        console.log(data);\n      }\n    }\n\n    const separator = (sectionID, rowID) => React.createElement(\"div\", {\n      key: \"\".concat(sectionID, \"-\").concat(rowID),\n      style: {\n        backgroundColor: '#F5F5F9',\n        height: 8,\n        borderTop: '1px solid #ECECED',\n        borderBottom: '1px solid #ECECED'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    });\n\n    let index = 0;\n\n    const row = (rowData, sectionID, rowID) => {\n      if (index <= data.length) {\n        const obj = data[index++];\n        let date;\n        return React.createElement(\"div\", {\n          key: rowID,\n          style: {\n            padding: '0 15px'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 144\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          style: {\n            lineHeight: '50px',\n            color: '#000',\n            fontSize: 18,\n            borderBottom: '1px solid #F6F6F6'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 145\n          },\n          __self: this\n        }, obj.movietitle), React.createElement(\"div\", {\n          style: {\n            display: '-webkit-box',\n            display: 'flex',\n            padding: '15px 0',\n            position: 'relative'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 153\n          },\n          __self: this\n        }, React.createElement(\"img\", {\n          style: {\n            height: '100px',\n            marginRight: '15px'\n          },\n          src: obj.movieimage,\n          alt: \"\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 154\n          },\n          __self: this\n        }), React.createElement(\"div\", {\n          style: {\n            lineHeight: 1\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 155\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          style: {\n            marginBottom: '15px',\n            marginTop: '5px',\n            fantSize: '13px',\n            color: '#666',\n            width: 'auto',\n            overflow: 'hidden',\n            textOverflow: 'ellipsis',\n            whiteSpace: 'nowrap'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 156\n          },\n          __self: this\n        }, \"\\u8BC4\\u5206\\uFF1A\", obj.moviemark), React.createElement(\"div\", {\n          style: {\n            marginBottom: '15px',\n            marginTop: '15px',\n            fantSize: '13px',\n            color: '#666',\n            width: 'auto',\n            overflow: 'hidden',\n            textOverflow: 'ellipsis',\n            whiteSpace: 'nowrap',\n            width: '10rem'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 157\n          },\n          __self: this\n        }, \"\\u5BFC\\u6F14\\uFF1A\", obj.moviedirect), React.createElement(\"div\", {\n          style: {\n            marginBottom: '15px',\n            marginTop: '15px',\n            fantSize: '13px',\n            color: '#666',\n            width: 'auto',\n            overflow: 'hidden',\n            textOverflow: 'ellipsis',\n            whiteSpace: 'nowrap',\n            width: '10rem'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 158\n          },\n          __self: this\n        }, \"\\u4E3B\\u6F14\\uFF1A\", obj.moviestar), React.createElement(\"div\", {\n          style: {\n            marginBottom: '15px',\n            marginTop: '15px',\n            fantSize: '13px',\n            color: '#666',\n            width: 'auto',\n            overflow: 'hidden',\n            textOverflow: 'ellipsis',\n            whiteSpace: 'nowrap',\n            width: '10rem'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 159\n          },\n          __self: this\n        }, \"\\u4E0A\\u6620\\u65F6\\u95F4\\uFF1A\", obj.moviedate)), React.createElement(IsPurser, {\n          isShow: this.props.isShow,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 162\n          },\n          __self: this\n        })));\n      }\n    };\n\n    return React.createElement(ListView, {\n      ref: el => this.lv = el,\n      initialListSize: data.length,\n      dataSource: this.state.dataSource,\n      renderFooter: () => React.createElement(\"div\", {\n        style: {\n          padding: 30,\n          textAlign: 'center'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173\n        },\n        __self: this\n      }, this.state.isLoading ? 'Loading...' : 'Loaded'),\n      renderRow: row,\n      renderSeparator: separator,\n      className: \"am-list\",\n      pageSize: 40,\n      useBodyScroll: true,\n      onScroll: () => {\n        console.log('scroll');\n      },\n      scrollRenderAheadDistance: 500,\n      onEndReached: this.onEndReached,\n      onEndReachedThreshold: 1000,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    });\n  }\n\n}","map":{"version":3,"sources":["E:/H5/react/taopiaopiao/src/components/List.js"],"names":["React","ListView","$","IsPurser","dataSource","DataSource","rowHasChanged","row1","row2","NUM_ROWS","genData","pIndex","dataBlob","i","ii","List","Component","constructor","props","onEndReached","event","state","isLoading","hasMore","console","log","setState","setTimeout","rData","pageIndex","cloneWithRows","isShow","data1","componentDidMount","ajax","url","type","dataType","success","data","JSON","parse","error","render","movielist","list1","list2","year","Date","getFullYear","month","getMonth","date","getDate","length","movieYear","Number","moviedate","substring","movieMonth","push","separator","sectionID","rowID","backgroundColor","height","borderTop","borderBottom","index","row","rowData","obj","padding","lineHeight","color","fontSize","movietitle","display","position","marginRight","movieimage","marginBottom","marginTop","fantSize","width","overflow","textOverflow","whiteSpace","moviemark","moviedirect","moviestar","el","lv","textAlign"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport './List.css'\r\nimport { ListView } from 'antd-mobile';\r\nimport $ from 'jquery';\r\nimport IsPurser from './IsPurser';\r\nconst dataSource = new ListView.DataSource({\r\n    rowHasChanged: (row1, row2) => row1 !== row2,\r\n});\r\nconst NUM_ROWS = 100;\r\nfunction genData(pIndex = 0) {\r\n    const dataBlob = {};\r\n    for (let i = 0; i < NUM_ROWS; i++) {\r\n        const ii = (pIndex * NUM_ROWS) + i;\r\n        dataBlob[`${ii}`] = `row - ${ii}`;\r\n    }\r\n    return dataBlob;\r\n}\r\n\r\nexport default class List extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            dataSource,\r\n            isLoading: true,\r\n            isShow: props.isShow,\r\n            NUM_ROWS: 40,\r\n            pageIndex: 0,\r\n            data1: [],\r\n        };\r\n    }\r\n    componentDidMount() {\r\n        console.log(this.state.isShow)\r\n        let data1=null;\r\n        $.ajax({\r\n            url: \"http://localhost:9000/getindex\",\r\n            type: \"GET\",\r\n            dataType: \"text\",\r\n            success(data) {\r\n                if (data) {\r\n                    data = JSON.parse(data);\r\n                    data1=data;\r\n                  \r\n                }\r\n            },\r\n            error() {\r\n  \r\n            }\r\n        });\r\n        setTimeout(()=> {\r\n            this.rData = genData();\r\n            this.setState({\r\n                dataSource: this.state.dataSource.cloneWithRows(this.rData),\r\n                isLoading: false,\r\n                data1:data1\r\n            });\r\n        }, 600);\r\n    }\r\n    \r\n    onEndReached = (event) => {\r\n        // load new data\r\n        // hasMore: from backend data, indicates whether it is the last page, here is false\r\n\r\n        if (this.state.isLoading && !this.state.hasMore) {\r\n            return;\r\n        }\r\n        console.log('reach end', event);\r\n        this.setState({ isLoading: true });\r\n        setTimeout(() => {\r\n            this.rData = { ...this.rData, ...this.genData(++this.pageIndex) };\r\n            this.setState({\r\n                dataSource: this.state.dataSource.cloneWithRows(this.rData),\r\n                isLoading: false,\r\n            });\r\n        }, 1000);\r\n    }\r\n\r\n    render() {\r\n        if (this.state.data1 != null) {\r\n            //所有的电影列表\r\n            let movielist = this.state.data1;\r\n            //已经上映的电影\r\n            let list1 = [];\r\n            //未上映的电影\r\n            let list2 = [];\r\n            let year = new Date().getFullYear();\r\n            let month = new Date().getMonth() + 1;\r\n            let date = new Date().getDate();\r\n            if (movielist != null) {\r\n                for (let i = 0; i < movielist.length; i++) {\r\n                    let movieYear = Number(movielist[i].moviedate.substring(0, 4));\r\n                    let movieMonth = Number(movielist[i].moviedate.substring(5, 7));\r\n                    let moviedate = Number(movielist[i].moviedate.substring(8, 10)) + 1;\r\n                    if (movieYear > year) {\r\n                        list2.push(movielist[i]);\r\n                    }\r\n                    else if (movieYear < year) {\r\n                        list1.push(movielist[i]);\r\n                    }\r\n                    else {\r\n                        if (movieMonth > month) {\r\n                            list2.push(movielist[i]);\r\n                        }\r\n                        else if (movieMonth < month) {\r\n                            list1.push(movielist[i]);\r\n                        }\r\n                        else {\r\n                            if (moviedate > date) {\r\n                                list2.push(movielist[i]);\r\n                            }\r\n                            else {\r\n                                list1.push(movielist[i]);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            var data=[];\r\n            if (this.state.isShow == true) {\r\n                data=list1;\r\n                console.log(data);\r\n            }\r\n            else {\r\n                data=list2;\r\n                console.log(data)\r\n            }\r\n        }\r\n        const separator = (sectionID, rowID) => (\r\n            <div\r\n                key={`${sectionID}-${rowID}`}\r\n                style={{\r\n                    backgroundColor: '#F5F5F9',\r\n                    height: 8,\r\n                    borderTop: '1px solid #ECECED',\r\n                    borderBottom: '1px solid #ECECED',\r\n                }}\r\n            />\r\n        );\r\n        let index = 0;\r\n        const row = (rowData, sectionID, rowID) => {\r\n            if (index <= data.length) {\r\n                const obj = data[index++];\r\n                let date\r\n                return (\r\n                    <div key={rowID} style={{ padding: '0 15px' }}>\r\n                        <div\r\n                            style={{\r\n                                lineHeight: '50px',\r\n                                color: '#000',\r\n                                fontSize: 18,\r\n                                borderBottom: '1px solid #F6F6F6',\r\n                            }}\r\n                        >{obj.movietitle}</div>\r\n                        <div style={{ display: '-webkit-box', display: 'flex', padding: '15px 0', position: 'relative' }}>\r\n                            <img style={{ height: '100px', marginRight: '15px' }} src={obj.movieimage} alt=\"\" />\r\n                            <div style={{ lineHeight: 1 }}>\r\n                                <div style={{ marginBottom: '15px', marginTop: '5px', fantSize: '13px', color: '#666', width: 'auto', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>评分：{obj.moviemark}</div>\r\n                                <div style={{ marginBottom: '15px', marginTop: '15px', fantSize: '13px', color: '#666', width: 'auto', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap',width:'10rem' }}>导演：{obj.moviedirect}</div>\r\n                                <div style={{ marginBottom: '15px', marginTop: '15px', fantSize: '13px', color: '#666', width: 'auto', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap',width:'10rem' }}>主演：{obj.moviestar}</div>\r\n                                <div style={{ marginBottom: '15px', marginTop: '15px', fantSize: '13px', color: '#666', width: 'auto', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap',width:'10rem' }}>上映时间：{obj.moviedate}</div>\r\n                            </div>\r\n\r\n                            <IsPurser isShow={this.props.isShow}></IsPurser>\r\n                        </div>\r\n                    </div>\r\n                );\r\n            }\r\n        };\r\n        return (\r\n            <ListView\r\n                ref={el => this.lv = el}\r\n                initialListSize={data.length}\r\n                dataSource={this.state.dataSource}\r\n                renderFooter={() => (<div style={{ padding: 30, textAlign: 'center' }}>\r\n                    {this.state.isLoading ? 'Loading...' : 'Loaded'}\r\n                </div>)}\r\n                renderRow={row}\r\n                renderSeparator={separator}\r\n                className=\"am-list\"\r\n                pageSize={40}\r\n                useBodyScroll\r\n                onScroll={() => { console.log('scroll'); }}\r\n                scrollRenderAheadDistance={500}\r\n                onEndReached={this.onEndReached}\r\n                onEndReachedThreshold={1000}\r\n            />\r\n        );\r\n    }\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}