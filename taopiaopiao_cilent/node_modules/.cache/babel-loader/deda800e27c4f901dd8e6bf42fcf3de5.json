{"ast":null,"code":"import _defineProperty from \"E:\\\\H5\\\\react\\\\taopiaopiao\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"E:\\\\H5\\\\react\\\\taopiaopiao\\\\src\\\\components\\\\List.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React from 'react';\nimport './List.css';\nimport { ListView } from 'antd-mobile';\nimport $ from 'jquery';\nimport IsPurser from './IsPurser';\nconst dataSource = new ListView.DataSource({\n  rowHasChanged: (row1, row2) => row1 !== row2\n}); // const NUM_ROWS = 20;\n// let pageIndex = 0;\n// function genData(pIndex = 0) {\n//     const dataBlob = {};\n//     for (let i = 0; i < NUM_ROWS; i++) {\n//         const ii = (pIndex * NUM_ROWS) + i;\n//         dataBlob[`${ii}`] = `row - ${ii}`;\n//     }\n//     return dataBlob;\n// }\n\nexport default class List extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.onEndReached = event => {\n      // load new data\n      // hasMore: from backend data, indicates whether it is the last page, here is false\n      if (this.state.isLoading && !this.state.hasMore) {\n        return;\n      }\n\n      console.log('reach end', event);\n      this.setState({\n        isLoading: true\n      });\n      setTimeout(() => {\n        this.rData = _objectSpread({}, this.rData, {}, this.genData(++this.pageIndex));\n        this.setState({\n          dataSource: this.state.dataSource.cloneWithRows(this.rData),\n          isLoading: false\n        });\n      }, 1000);\n    };\n\n    this.state = {\n      dataSource,\n      isLoading: true,\n      isShow: props.isShow,\n      NUM_ROWS: 20,\n      pageIndex: 0,\n      data1: null,\n      data: [{\n        movieimage: 'https://gw.alicdn.com/i1/TB1J0Hkk.Y1gK0jSZFMXXaWcVXa_.jpg_160x160Q30s100.jpg_.webp',\n        movietitle: '冰雪奇缘2',\n        moviemark: '暂无评分',\n        moviedirect: '巴克',\n        moviestar: '贝尔',\n        id: '1'\n      }, {\n        movieimage: 'https://gw.alicdn.com/i4/TB1gxsmmhz1gK0jSZSgXXavwpXa_.jpg_160x160Q30s100.jpg_.webp',\n        movietitle: '你是凶手',\n        moviemark: '8.2',\n        moviedirect: '王立',\n        moviestar: '王千源 宋佳',\n        id: '2'\n      }, {\n        movieimage: 'https://gw.alicdn.com/i4/TB1FwROmq61gK0jSZFlXXXDKFXa_.jpg_160x160Q30s100.jpg_.webp',\n        movietitle: '触不可及',\n        moviemark: '9.1',\n        moviedirect: '尼尔·博格',\n        moviestar: '布莱恩·科兰斯顿',\n        id: '3'\n      }]\n    };\n  }\n\n  componentDidMount() {\n    console.log(this.state.isShow);\n    let that = this;\n    $.ajax({\n      url: \"http://localhost:9000/getindex\",\n      type: \"GET\",\n      dataType: \"text\",\n\n      success(data) {\n        if (data) {\n          data = JSON.parse(data);\n          that.setState({\n            data1: data\n          });\n        }\n      },\n\n      error() {}\n\n    });\n    setTimeout(() => {\n      this.rData = this.genData();\n      this.setState({\n        dataSource: this.state.dataSource.cloneWithRows(this.rData),\n        isLoading: false\n      });\n    }, 600);\n  }\n\n  genData(pIndex = 0) {\n    const dataBlob = {};\n\n    for (let i = 0; i < this.state.NUM_ROWS; i++) {\n      const ii = pIndex * this.state.NUM_ROWS + i;\n      dataBlob[\"\".concat(ii)] = \"row - \".concat(ii);\n    }\n\n    return dataBlob;\n  }\n\n  render() {\n    if (this.state.data1 != null) {\n      console.log(this.state.data1);\n\n      const separator = (sectionID, rowID) => React.createElement(\"div\", {\n        key: \"\".concat(sectionID, \"-\").concat(rowID),\n        style: {\n          backgroundColor: '#F5F5F9',\n          height: 8,\n          borderTop: '1px solid #ECECED',\n          borderBottom: '1px solid #ECECED'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        },\n        __self: this\n      });\n\n      let index = 0;\n\n      const row = (rowData, sectionID, rowID) => {\n        if (index <= this.state.data.length) {\n          const obj = this.state.data[index++];\n          return React.createElement(\"div\", {\n            key: rowID,\n            style: {\n              padding: '0 15px'\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 135\n            },\n            __self: this\n          }, React.createElement(\"div\", {\n            style: {\n              lineHeight: '50px',\n              color: '#000',\n              fontSize: 18,\n              borderBottom: '1px solid #F6F6F6'\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 136\n            },\n            __self: this\n          }, obj.movietitle), React.createElement(\"div\", {\n            style: {\n              display: '-webkit-box',\n              display: 'flex',\n              padding: '15px 0',\n              position: 'relative'\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 144\n            },\n            __self: this\n          }, React.createElement(\"img\", {\n            style: {\n              height: '100px',\n              marginRight: '15px'\n            },\n            src: obj.movieimage,\n            alt: \"\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 145\n            },\n            __self: this\n          }), React.createElement(\"div\", {\n            style: {\n              lineHeight: 1\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 146\n            },\n            __self: this\n          }, React.createElement(\"div\", {\n            style: {\n              marginBottom: '15px',\n              marginTop: '15px',\n              fantSize: '13px',\n              color: '#666',\n              width: 'auto',\n              overflow: 'hidden',\n              textOverflow: 'ellipsis',\n              whiteSpace: 'nowrap'\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 147\n            },\n            __self: this\n          }, \"\\u8BC4\\u5206\\uFF1A\", obj.moviemark), React.createElement(\"div\", {\n            style: {\n              marginBottom: '15px',\n              marginTop: '15px',\n              fantSize: '13px',\n              color: '#666',\n              width: 'auto',\n              overflow: 'hidden',\n              textOverflow: 'ellipsis',\n              whiteSpace: 'nowrap'\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 148\n            },\n            __self: this\n          }, \"\\u5BFC\\u6F14\\uFF1A\", obj.moviedirect), React.createElement(\"div\", {\n            style: {\n              marginBottom: '15px',\n              marginTop: '15px',\n              fantSize: '13px',\n              color: '#666',\n              width: 'auto',\n              overflow: 'hidden',\n              textOverflow: 'ellipsis',\n              whiteSpace: 'nowrap'\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 149\n            },\n            __self: this\n          }, \"\\u4E3B\\u6F14\\uFF1A\", obj.moviestar)), React.createElement(IsPurser, {\n            isShow: this.props.isShow,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 153\n            },\n            __self: this\n          })));\n        }\n      };\n\n      return React.createElement(ListView, {\n        ref: el => this.lv = el,\n        initialListSize: this.state.data.length,\n        dataSource: this.state.dataSource,\n        renderHeader: () => React.createElement(\"span\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 164\n          },\n          __self: this\n        }, \"header\"),\n        renderFooter: () => React.createElement(\"div\", {\n          style: {\n            padding: 30,\n            textAlign: 'center'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 165\n          },\n          __self: this\n        }, this.state.isLoading ? 'Loading...' : 'Loaded'),\n        renderRow: row,\n        renderSeparator: separator,\n        className: \"am-list\",\n        pageSize: 4,\n        useBodyScroll: true,\n        onScroll: () => {\n          console.log('scroll');\n        },\n        scrollRenderAheadDistance: 500,\n        onEndReached: this.onEndReached,\n        onEndReachedThreshold: 10,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160\n        },\n        __self: this\n      });\n    }\n  }\n\n}","map":{"version":3,"sources":["E:/H5/react/taopiaopiao/src/components/List.js"],"names":["React","ListView","$","IsPurser","dataSource","DataSource","rowHasChanged","row1","row2","List","Component","constructor","props","onEndReached","event","state","isLoading","hasMore","console","log","setState","setTimeout","rData","genData","pageIndex","cloneWithRows","isShow","NUM_ROWS","data1","data","movieimage","movietitle","moviemark","moviedirect","moviestar","id","componentDidMount","that","ajax","url","type","dataType","success","JSON","parse","error","pIndex","dataBlob","i","ii","render","separator","sectionID","rowID","backgroundColor","height","borderTop","borderBottom","index","row","rowData","length","obj","padding","lineHeight","color","fontSize","display","position","marginRight","marginBottom","marginTop","fantSize","width","overflow","textOverflow","whiteSpace","el","lv","textAlign"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport './List.css'\r\nimport { ListView } from 'antd-mobile';\r\nimport $ from 'jquery';\r\nimport IsPurser from './IsPurser';\r\nconst dataSource = new ListView.DataSource({\r\n    rowHasChanged: (row1, row2) => row1 !== row2,\r\n});\r\n// const NUM_ROWS = 20;\r\n// let pageIndex = 0;\r\n\r\n// function genData(pIndex = 0) {\r\n//     const dataBlob = {};\r\n//     for (let i = 0; i < NUM_ROWS; i++) {\r\n//         const ii = (pIndex * NUM_ROWS) + i;\r\n//         dataBlob[`${ii}`] = `row - ${ii}`;\r\n//     }\r\n//     return dataBlob;\r\n// }\r\n\r\nexport default class List extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            dataSource,\r\n            isLoading: true,\r\n            isShow:props.isShow,\r\n             NUM_ROWS: 20,\r\n             pageIndex: 0,\r\n             data1:null,\r\n            data: [\r\n                {\r\n                    movieimage: 'https://gw.alicdn.com/i1/TB1J0Hkk.Y1gK0jSZFMXXaWcVXa_.jpg_160x160Q30s100.jpg_.webp',\r\n                    movietitle: '冰雪奇缘2',\r\n                    moviemark: '暂无评分',\r\n                    moviedirect: '巴克',\r\n                    moviestar: '贝尔',\r\n                    id:'1'\r\n                },\r\n                {\r\n                    movieimage: 'https://gw.alicdn.com/i4/TB1gxsmmhz1gK0jSZSgXXavwpXa_.jpg_160x160Q30s100.jpg_.webp',\r\n                    movietitle: '你是凶手',\r\n                    moviemark: '8.2',\r\n                    moviedirect: '王立',\r\n                    moviestar: '王千源 宋佳',\r\n                    id:'2'\r\n                },\r\n                {\r\n                    movieimage: 'https://gw.alicdn.com/i4/TB1FwROmq61gK0jSZFlXXXDKFXa_.jpg_160x160Q30s100.jpg_.webp',\r\n                    movietitle: '触不可及',\r\n                    moviemark: '9.1',\r\n                    moviedirect: '尼尔·博格',\r\n                    moviestar: '布莱恩·科兰斯顿',\r\n                    id:'3'\r\n                },\r\n            ],\r\n        };\r\n    }\r\n    \r\n    componentDidMount() {\r\n      console.log(this.state.isShow)\r\n      let that = this;\r\n        $.ajax({\r\n            url: \"http://localhost:9000/getindex\",\r\n            type: \"GET\",\r\n            dataType: \"text\",\r\n            success(data) {\r\n                if (data) {\r\n                    data = JSON.parse(data);\r\n                    that.setState({\r\n                        data1: data\r\n                    })\r\n                }\r\n            },\r\n            error() {\r\n\r\n            }\r\n        })\r\n        setTimeout(() => {\r\n            this.rData = this.genData();\r\n            this.setState({\r\n                dataSource: this.state.dataSource.cloneWithRows(this.rData),\r\n                isLoading: false,\r\n            });\r\n        }, 600);\r\n    }\r\n\r\n    genData(pIndex = 0) {\r\n        const dataBlob = {};\r\n        for (let i = 0; i < this.state.NUM_ROWS; i++) {\r\n            const ii = (pIndex * this.state.NUM_ROWS) + i;\r\n            dataBlob[`${ii}`] = `row - ${ii}`;\r\n        }\r\n        return dataBlob;\r\n    }\r\n    onEndReached = (event) => {\r\n        // load new data\r\n        // hasMore: from backend data, indicates whether it is the last page, here is false\r\n\r\n        if (this.state.isLoading && !this.state.hasMore) {\r\n            return;\r\n        }\r\n        console.log('reach end', event);\r\n        this.setState({ isLoading: true });\r\n        setTimeout(() => {\r\n            this.rData = { ...this.rData, ...this.genData(++this.pageIndex) };\r\n            this.setState({\r\n                dataSource: this.state.dataSource.cloneWithRows(this.rData),\r\n                isLoading: false,\r\n            });\r\n        }, 1000);\r\n    }\r\n\r\n    render() {\r\n        if(this.state.data1!=null){\r\n            console.log(this.state.data1);\r\n        \r\n       \r\n        const separator = (sectionID, rowID) => (\r\n            <div\r\n                key={`${sectionID}-${rowID}`}\r\n                style={{\r\n                    backgroundColor: '#F5F5F9',\r\n                    height: 8,\r\n                    borderTop: '1px solid #ECECED',\r\n                    borderBottom: '1px solid #ECECED',\r\n                }}\r\n            />\r\n        );\r\n        let index = 0;\r\n        const row = (rowData, sectionID, rowID) => {\r\n            if (index <= this.state.data.length) {\r\n                const obj = this.state.data[index++];\r\n                return (\r\n                    <div key={rowID} style={{ padding: '0 15px' }}>\r\n                        <div\r\n                            style={{\r\n                                lineHeight: '50px',\r\n                                color: '#000',\r\n                                fontSize: 18,\r\n                                borderBottom: '1px solid #F6F6F6',\r\n                            }}\r\n                        >{obj.movietitle}</div>\r\n                        <div style={{ display: '-webkit-box', display: 'flex', padding: '15px 0',position:'relative' }}>\r\n                            <img style={{ height: '100px', marginRight: '15px' }} src={obj.movieimage} alt=\"\" />\r\n                            <div style={{ lineHeight: 1 }}>\r\n                                <div style={{ marginBottom: '15px', marginTop: '15px', fantSize: '13px', color: '#666', width: 'auto', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>评分：{obj.moviemark}</div>\r\n                                <div style={{ marginBottom: '15px', marginTop: '15px', fantSize: '13px', color: '#666', width: 'auto', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>导演：{obj.moviedirect}</div>\r\n                                <div style={{ marginBottom: '15px', marginTop: '15px', fantSize: '13px', color: '#666', width: 'auto', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>主演：{obj.moviestar}</div>\r\n                               \r\n                            </div>\r\n                            \r\n                            <IsPurser isShow={this.props.isShow}></IsPurser>\r\n                        </div>\r\n                    </div>\r\n                );\r\n            }\r\n        };\r\n        return (\r\n            <ListView\r\n                ref={el => this.lv = el}\r\n                initialListSize={this.state.data.length}\r\n                dataSource={this.state.dataSource}\r\n                renderHeader={() => <span>header</span>}\r\n                renderFooter={() => (<div style={{ padding: 30, textAlign: 'center' }}>\r\n                    {this.state.isLoading ? 'Loading...' : 'Loaded'}\r\n                </div>)}\r\n                renderRow={row}\r\n                renderSeparator={separator}\r\n                className=\"am-list\"\r\n                pageSize={4}\r\n                useBodyScroll\r\n                onScroll={() => { console.log('scroll'); }}\r\n                scrollRenderAheadDistance={500}\r\n                onEndReached={this.onEndReached}\r\n                onEndReachedThreshold={10}\r\n            />\r\n        );\r\n    }\r\n}\r\n}"]},"metadata":{},"sourceType":"module"}